---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r include = FALSE}
knitr::opts_chunk$set(warning=FALSE,message=FALSE)

```

For this exercise, we shall use the following libraries to load, process and produce the results for each of the section below:

* **lubridate** : For managing date variables.
* **readr**     : For reading in data into a data frame from source.
* **dplyr**     : For data manipulation.
* **purrr**     : For functional programming capabilities.
* **ggplot2**   : For data visualization.
* **skimr**     : For summary statistics of the data set.
* **kableExtra**: For displaying tables in HTML documents.

Let's install and load these packages into the R Environment:

```{r load_packages}
pkgs <- c('lubridate', 'readr', 'dplyr', 'ggplot2', 'purrr', 'skimr', 'kableExtra')
install.packages(pkgs[!(pkgs %in% installed.packages())]) # Install any missing packages
purrr::walk(pkgs, function(pkg) require(pkg, character.only = TRUE)) # Load packages

```

## Loading and preprocessing the data

Let's load the data from source and structure it into a format that we can use.

```{r data_processing_part1}
url <- 'https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip'
data_name <- 'activity.zip'

if(!file.exists(data_name)) { # Download data if required
  download.file(url = url, destfile = data_name)
}

activity <- read_csv(data_name) # read_csv can read and load zipped contents.

# Analyse the data for anomolies.
(skim_with(numeric = sfl(hist = NULL)))(activity)

```

From the analysis, we can see that the *steps* variable has ```r format(round(((is.na(activity$steps) %>% sum) / nrow(activity) * 100), 2), nsmall = 2)```% as *NA's*. We can also see that its heavily skewed to the right, indicating that the use of the average value may not be the best use of measure for the NA values. 

To keep it simple for this exercise, we shall replace the NA's with the **Median**.

```{r data_processing_part2}
activity$steps <- replace(
  x = activity$steps, 
  list = which(is.na(activity$steps), arr.ind = TRUE), 
  values = median(activity$steps, na.rm = TRUE))

```

With the pre-processing done, our data for analysis looks as follows:

```{r data_processing_summary} 

activity %>% 
  kbl() %>% 
  kable_classic(
    bootstrap_options = "striped", font_size = 10) %>% 
  scroll_box(height = "200px")

```

## What is mean total number of steps taken per day?

For this part of the assignment, I have used the cleaned data that replaced the NA values of the steps variable with the median.

Answering this question will take a three-step approach:

**1. Calculate the total number of steps taken per day**

```{r total_daily_steps}

total_daily_steps <- activity %>% 
  group_by(date) %>% 
  summarize(total_steps = sum(steps)) %>% 
  ungroup()

total_daily_steps %>%
  kbl() %>% kable_classic(
    bootstrap_options = "striped", font_size = 10) %>%
  scroll_box(height = "200px")


```

**2. Make a histogram of the total number of steps taken per day**

```{r histogram_total_steps}
total_daily_steps %>% 
  ggplot(aes(x = total_steps)) + 
  geom_histogram() + 
  labs(
    x = 'Total Steps', 
    y = 'Frequency',
    title = 'Histogram on the total steps per day',
    caption = 'October and November 2021'
  ) + 
  theme_bw()

```

**3. Calculate and report the mean and median of the total number of steps taken per day**

For the period between October and November 2021, the statistics of interest are as below:

* Median number of steps : `r format(round(median(activity$steps), 2), nsmall = 2)` steps
* Mean number of steps   : `r format(round(mean(activity$steps), 2), nsmall = 2)` steps.

## What is the average daily activity pattern?



## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
